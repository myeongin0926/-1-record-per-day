---

### 🔍 인증에 대해 공부하게된 계기

나는 웹개발을 시작하고 여태까지 가장 구현해보고 싶었던 기능이 단연 로그인 기능이였다.

로컬 스토리지를 통해 겉핥기로 구현할 수 있었지만 이는 보안 등 전혀 말도 안되는 방법이라는걸 알고있었다.

쿠키, 세션, 토큰을 사용하여 유저 정보를 어떻게 저장하고, 어떻게 보안을 유지하는지 궁금했다.

이번 파트에서는 이 궁금증을 해결해보려고 한다.

---

### 📌 Cookie?

쿠키를 처음 들었을때는 먹는 쿠키..? 라는 생각이 들었다. 나와 같은 생각을 한 사람이 없지는 않을 것 같다

쿠키에 대한 나의 이해는 이렇다.

**HTTP의 무상태성으로 인해 서버는 내가 누군지 모른다 그렇기에 나는 매번 내가 누군지 알려줘야 하는것이다.**

클라이언트가 웹 서버에게 요청을 보낼 때, 클라이언트 자신을 식별하기 위한 정보가 필요하다.

이때 정보를 저장하기 위해 사용되는것을 쿠키라고 한다.

쿠키는 클라이언트의 웹 브라우저에 저장되어 웹 사이트에서 읽고 쓸 수 있는 작은 데이터 조각이다.

클라이언트가 서버에 요청을 보낼 때, 쿠키를 함께 전송하여 서버가 클라이언트를 식별하고

이전에 저장한 정보를 활용할 수 있게 됩니다.

서버와 클라이언트로 구분지으면 이해가 쉽지많은 않으니 예시를 들어보자.

나는 사우나에 갔고, 나에대한 정보가 들어있는 손목키를 발급받은 상황이다.

**사우나 내에 서비스를 이용하려 할 때, 직원은 내가 서비스를 이용할 수 있는 사람인지, 아닌지를 확인하기 위해.**

**즉, 나의 신원을 확인하기 위해 나의 손목키를 확인할것이다. 이 손목키는 사우나에서 발급해주는것이며**

**내가 임의로 삭제, 수정할 수 있다는점이 있다. 여기서 손목키 역할을 브라우저에서는 쿠키가 하는것이다.**

쿠키의 특징은 여러가지가 있지만 짧게 살펴보자면.

- 쿠키 전송 여부는 내가 정하는것이 아니며 해당 도메인에 쿠키가 저장되어 있다면 자동으로 전송된다.
- 쿠키는 서버에서 지정해놓은 특정 조건들이 만족되어야 전송이 이루어진다.

### **쿠키 옵션 설정 방법과 쿠키 옵션의 종류**

쿠키 옵션은 아래코드 처럼 http 헤더를 사용해 **쿠키 옵션**으로 표현할 수 있다.

```jsx

"Set-Cookie": [
    "cookie=yummy",
    "Secure=Secure; Secure",
    "HttpOnly=HttpOnly; HttpOnly",
    "Path=Path; Path=/cookie",
    "Doamin=Domain; Domain=codestates.com",
  ],
```

[쿠키 옵션의 종류](https://ko.javascript.info/cookie)

 

---

### 📌 Session?

**Session은 서버에 정보를 저장하기 위해 사용된다.**

**방금 정보를 저장하는 Cookie에 대해 배웠는데 이 둘은 무엇이 다르며 Session이 무엇인지 알아보자.**

쿠키와 세션의 가장 큰 차이점은 “어디에 저장되는가” 이다.

쿠키는 브라우저에 저장된다. 즉, 유저가 가지고 있는것이고 반대로 세션은 서버에 저장된다. 

이렇게 브라우저와 서버에 데이터를 각각 저장하는 이유는 데이터의 보안에 있다.

---

### **로그인 과정을 예시로 쿠키와 세션 생성 과정**

![스크린샷 2023-07-01 오후 10.23.18.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/748f2bed-0d07-4041-8405-96aff6740cfd/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-01_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_10.23.18.png)

1. **유저는 아이디와 비밀번호를 가지고 서버에 로그인 요청을 보낸다.**
2. **서버는 사용자 정보DB에서 해당하는 유저를 찾는다.**
3. **해당하는 유저가 존재하지 않는다면 서버는 클라이언트에게 로그인 실패 응답을 보낸다.
해당하는 유저가 존재한다면 세션ID를 생성하고 유저 정보와 세션 ID를 세션 DB에 저장하고 
세션ID를 쿠키에 담아 응답에 싣어 보낸다.**
4. **이후 유저는 매 요청마다 세션ID를 담아 보내고, 서버는 해당 세션ID를 세션DB에서 찾은 이후에
해당하는 유저의 정보를 업데이트 한다.**

---

세션을 사용하는 이유는 보안에 있다고 했다. 

유저 정보는 더 이상 왔다갔다 하지 않으며, 세션ID를 교환하므로써 안전성을 더 높일수 있다.